(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9c8dbe88"],{"213d":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat-room"},[s("div",{staticClass:"chat-content"},[s("div",{staticClass:"chat-header",staticStyle:{"border-bottom":"1px solid #ccc"}},[s("span",{staticStyle:{"font-size":"22px"}},[e._v(e._s(e.userInfo.nickname))]),s("svg-icon",{staticStyle:{width:"25px",height:"25px"},attrs:{"icon-class":"more"}})],1),s("div",{staticClass:"chat-body",staticStyle:{height:"100%","padding-top":"20px"}},e._l(e.msgLists,(function(t,n){return s("div",{key:n,staticClass:"chat-main",class:{"chat-mine":t.isSender}},[s("div",{staticClass:"chat-user"},[t.avatar?s("img",{attrs:{src:t.avatar}}):s("span",{staticClass:"text-photo"},[e._v(e._s(t.nickname))]),s("cite",[s("i",[e._v(e._s(e._f("formatTime")(t.create_time)))])])]),s("div",{staticClass:"chat-text"},[e._v(e._s(t.message))])])})),0),s("div",{staticClass:"chat-bottom"},[s("el-input",{staticStyle:{"margin-right":"20px"},attrs:{placeholder:"请输入要发送的内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMsg(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),s("el-button",{attrs:{type:"primary"},on:{click:e.sendMsg}},[e._v("发送")])],1)])])},a=[],i=(s("4160"),s("498a"),s("159b"),s("5530")),r=s("b775"),o=function(e){return Object(r["a"])({method:"post",data:e,url:"/user/getUserInfo"})},c=s("25a9"),u=s("2f62"),f={props:["id"],data:function(){return{userInfo:{avatar:"",nickname:""},message:"",msgLists:[]}},filters:{formatTime:function(e){if(null==e||""===e)return"";var t=new Date(e);return Object(c["a"])(t,"yyyy-MM-dd hh:mm:ss")}},created:function(){var e=this;this.$socket.emit("show_messages",{sender:"store_"+this.storeInfo.id,receiver:"user_"+this.id}),o({id:this.id}).then((function(t){e.userInfo=t.data.data[0],console.log(t.data.data[0]),console.log(e.storeInfo)}))},computed:Object(i["a"])({},Object(u["c"])(["storeInfo"])),methods:{sendMsg:function(){var e=this.message.trim();console.log(e),e&&(this.msgLists.push({nickname:this.storeInfo.nickname,avatar:this.storeInfo.avatar,isSender:!0,create_time:Date.now(),message:this.message}),this.message="",this.$socket.emit("send_message",{sender:"store_"+this.storeInfo.id,receiver:"user_"+this.id,msg:e}))}},sockets:{return_messages:function(e){var t=this,s=[];e.forEach((function(e){"1"==e.client?(e.isSender=!1,e=Object.assign(e,t.userInfo)):e=Object.assign(e,{nickname:t.storeInfo.nickname,avatar:t.storeInfo.avatar,isSender:!0}),s.push(e)})),console.log(s),this.msgLists=s},receive_message:function(e){this.msgLists.push(Object.assign({message:e},{nickname:this.userInfo.nickname,avatar:this.userInfo.avatar,isSender:!1}))}},beforeDestroy:function(){this.$socket.emit("change",{sender:"store_"+this.storeInfo.id,receiver:"user_"+this.id})},beforeRouteUpdate:function(e,t,s){this.$socket.emit("change",{sender:"store_"+this.storeInfo.id,receiver:"user_"+this.$route.params.id})}},d=f,g=(s("e7e2"),s("2877")),l=Object(g["a"])(d,n,a,!1,null,"5a2da76c",null);t["default"]=l.exports},"25a9":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return i}));s("c975"),s("4d63"),s("ac1f"),s("25f0"),s("5319"),s("1276");function n(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var s={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in s)if(new RegExp("(".concat(n,")")).test(t)){var i=s[n]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?i:a(i))}return t}function a(e){return("00"+e).substr(e.length)}function i(e,t){t||(t="-");var s,n=e.split(t),a=parseInt(n[0]);s=0==n[1].indexOf("0")?parseInt(n[1].substring(1)):parseInt(n[1]);var i=parseInt(n[2]),r=new Date(a,s-1,i);return r}},"25f0":function(e,t,s){"use strict";var n=s("6eeb"),a=s("825a"),i=s("d039"),r=s("ad6d"),o="toString",c=RegExp.prototype,u=c[o],f=i((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),d=u.name!=o;(f||d)&&n(RegExp.prototype,o,(function(){var e=a(this),t=String(e.source),s=e.flags,n=String(void 0===s&&e instanceof RegExp&&!("flags"in c)?r.call(e):s);return"/"+t+"/"+n}),{unsafe:!0})},"4d63":function(e,t,s){var n=s("83ab"),a=s("da84"),i=s("94ca"),r=s("7156"),o=s("9bf2").f,c=s("241c").f,u=s("44e7"),f=s("ad6d"),d=s("9f7f"),g=s("6eeb"),l=s("d039"),h=s("69f3").set,p=s("2626"),m=s("b622"),v=m("match"),b=a.RegExp,_=b.prototype,y=/a/g,k=/a/g,x=new b(y)!==y,I=d.UNSUPPORTED_Y,E=n&&i("RegExp",!x||I||l((function(){return k[v]=!1,b(y)!=y||b(k)==k||"/a/i"!=b(y,"i")})));if(E){var w=function(e,t){var s,n=this instanceof w,a=u(e),i=void 0===t;if(!n&&a&&e.constructor===w&&i)return e;x?a&&!i&&(e=e.source):e instanceof w&&(i&&(t=f.call(e)),e=e.source),I&&(s=!!t&&t.indexOf("y")>-1,s&&(t=t.replace(/y/g,"")));var o=r(x?new b(e,t):b(e,t),n?this:_,w);return I&&s&&h(o,{sticky:s}),o},S=function(e){e in w||o(w,e,{configurable:!0,get:function(){return b[e]},set:function(t){b[e]=t}})},R=c(b),O=0;while(R.length>O)S(R[O++]);_.constructor=w,w.prototype=_,g(a,"RegExp",w)}p("RegExp")},bdc1:function(e,t,s){},e7e2:function(e,t,s){"use strict";var n=s("bdc1"),a=s.n(n);a.a}}]);